{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport * as favoritesService from '../services/favoritesService';\n\n// Async thunk для загрузки избранного с учетом пользователя\nexport const loadFavorites = createAsyncThunk('favorites/loadFavorites', async (user, thunkAPI) => {\n  const result = await favoritesService.loadFavorites(user);\n  return result;\n});\n\n// Async thunk для сохранения избранного\nexport const saveFavorites = createAsyncThunk('favorites/saveFavorites', async ({\n  user,\n  favorites\n}, thunkAPI) => {\n  await favoritesService.saveFavorites(user, favorites);\n  return favorites;\n});\nconst favoritesSlice = createSlice({\n  name: 'favorites',\n  initialState: {\n    favorites: [],\n    selected: [],\n    loading: false,\n    error: null,\n    mergedWithLocal: false,\n    user: null\n  },\n  reducers: {\n    toggleSelect(state, action) {\n      const title = action.payload;\n      if (state.selected.includes(title)) {\n        state.selected = state.selected.filter(t => t !== title);\n      } else {\n        state.selected.push(title);\n      }\n    },\n    unselectAll(state) {\n      state.selected = [];\n    },\n    removeSelected(state) {\n      state.favorites = state.favorites.filter(book => !state.selected.includes(book.title));\n      state.selected = [];\n    },\n    clearAll(state) {\n      state.favorites = [];\n      state.selected = [];\n    },\n    setUser(state, action) {\n      state.user = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(loadFavorites.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(loadFavorites.fulfilled, (state, action) => {\n      state.loading = false;\n      state.favorites = action.payload.favorites;\n      state.mergedWithLocal = action.payload.mergedWithLocal;\n    }).addCase(loadFavorites.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.error.message;\n    }).addCase(saveFavorites.fulfilled, (state, action) => {\n      state.favorites = action.payload;\n    }).addCase(saveFavorites.rejected, (state, action) => {\n      state.error = action.error.message;\n    });\n  }\n});\nexport const {\n  toggleSelect,\n  unselectAll,\n  removeSelected,\n  clearAll,\n  setUser\n} = favoritesSlice.actions;\nexport default favoritesSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","favoritesService","loadFavorites","user","thunkAPI","result","saveFavorites","favorites","favoritesSlice","name","initialState","selected","loading","error","mergedWithLocal","reducers","toggleSelect","state","action","title","payload","includes","filter","t","push","unselectAll","removeSelected","book","clearAll","setUser","extraReducers","builder","addCase","pending","fulfilled","rejected","message","actions","reducer"],"sources":["/Users/alnura/Desktop/BookStore-React/src/features/favoritesSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport * as favoritesService from '../services/favoritesService';\n\n// Async thunk для загрузки избранного с учетом пользователя\nexport const loadFavorites = createAsyncThunk(\n  'favorites/loadFavorites',\n  async (user, thunkAPI) => {\n    const result = await favoritesService.loadFavorites(user);\n    return result;\n  }\n);\n\n// Async thunk для сохранения избранного\nexport const saveFavorites = createAsyncThunk(\n  'favorites/saveFavorites',\n  async ({ user, favorites }, thunkAPI) => {\n    await favoritesService.saveFavorites(user, favorites);\n    return favorites;\n  }\n);\n\nconst favoritesSlice = createSlice({\n  name: 'favorites',\n  initialState: {\n    favorites: [],\n    selected: [],\n    loading: false,\n    error: null,\n    mergedWithLocal: false,\n    user: null,\n  },\n  reducers: {\n    toggleSelect(state, action) {\n      const title = action.payload;\n      if (state.selected.includes(title)) {\n        state.selected = state.selected.filter(t => t !== title);\n      } else {\n        state.selected.push(title);\n      }\n    },\n    unselectAll(state) {\n      state.selected = [];\n    },\n    removeSelected(state) {\n      state.favorites = state.favorites.filter(book => !state.selected.includes(book.title));\n      state.selected = [];\n    },\n    clearAll(state) {\n      state.favorites = [];\n      state.selected = [];\n    },\n    setUser(state, action) {\n      state.user = action.payload;\n    }\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(loadFavorites.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(loadFavorites.fulfilled, (state, action) => {\n        state.loading = false;\n        state.favorites = action.payload.favorites;\n        state.mergedWithLocal = action.payload.mergedWithLocal;\n      })\n      .addCase(loadFavorites.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.error.message;\n      })\n      .addCase(saveFavorites.fulfilled, (state, action) => {\n        state.favorites = action.payload;\n      })\n      .addCase(saveFavorites.rejected, (state, action) => {\n        state.error = action.error.message;\n      });\n  }\n});\n\nexport const { toggleSelect, unselectAll, removeSelected, clearAll, setUser } = favoritesSlice.actions;\nexport default favoritesSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}